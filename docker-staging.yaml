version: "3.9"

services:
  bot:
    image: "ghcr.io/dawnbrandbots/bastion-bot:${DOCKER_TAG:-latest}"
    environment:
      DEBUG: "*"
      DISCORD_TOKEN:
      SEARCH_API:
      IMAGE_HOST:
      FTP_URL:
      DISCORD_SHARD: "{{.Task.Slot}}"
      DISCORD_TOTAL_SHARDS:
      BOT_LOGGER_WEBHOOK: "${BOT_LOGGER_WEBHOOK:-}"
      BOT_PRESENCE: "${BOT_PRESENCE:-}"
      BOT_MOTD: "${BOT_MOTD:-}"
      BOT_NO_DIRECT_MESSAGE_SEARCH: 1
    deploy:
      replicas: ${DISCORD_TOTAL_SHARDS}
    restart: unless-stopped
    logging:
      driver: journald
networks:
  default:
    external: true
    name: royal-magical-library_default
