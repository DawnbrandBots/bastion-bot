version: "3.9"

services:
  bot:
    build: .
    image: ghcr.io/kevinlul/discord-bot-template
    environment:
      DEBUG: "*"
      DISCORD_TOKEN: "${DISCORD_TOKEN}"
      DISCORD_SHARD: "{{.Task.Slot}}"
      DISCORD_TOTAL_SHARDS: ${DISCORD_TOTAL_SHARDS}
    deploy:
      replicas: ${DISCORD_TOTAL_SHARDS}
    restart: unless-stopped
    logging:
      driver: "${DOCKER_LOG_DRIVER:-journald}"
networks:
  default:
    external: "${DOCKER_EXTERNAL_NETWORK:-true}"
    name: "${DOCKER_NETWORK:-royal-magical-library_default}"
